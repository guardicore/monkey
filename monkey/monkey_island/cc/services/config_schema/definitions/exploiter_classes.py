from monkey_island.cc.services.utils.typographic_symbols import WARNING_SIGN

EXPLOITER_CLASSES = {
    "title": "Exploiters",
    "description": "Click on exploiter to get more information about it."
    + WARNING_SIGN
    + " Note that using unsafe exploits may cause crashes of the exploited "
    "machine/service.",
    "type": "string",
    "anyOf": [
        {
            "type": "string",
            "enum": ["SmbExploiter"],
            "title": "SMB Exploiter",
            "safe": True,
            "attack_techniques": ["T1110", "T1075", "T1035"],
            "info": "Brute forces using credentials provided by user and"
            " hashes gathered by mimikatz.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference"
            "/exploiters/smbexec/",
        },
        {
            "type": "string",
            "enum": ["WmiExploiter"],
            "title": "WMI Exploiter",
            "safe": True,
            "attack_techniques": ["T1110", "T1106"],
            "info": "Brute forces WMI (Windows Management Instrumentation) "
            "using credentials provided by user and hashes gathered by "
            "mimikatz.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference"
            "/exploiters/wmiexec/",
        },
        {
            "type": "string",
            "enum": ["MSSQLExploiter"],
            "title": "MSSQL Exploiter",
            "safe": True,
            "attack_techniques": ["T1110"],
            "info": "Tries to brute force into MsSQL server and uses insecure "
            "configuration to execute commands on server.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference"
            "/exploiters/mssql/",
        },
        {
            "type": "string",
            "enum": ["SSHExploiter"],
            "title": "SSH Exploiter",
            "safe": True,
            "attack_techniques": ["T1110", "T1145", "T1106"],
            "info": "Brute forces using credentials provided by user and SSH keys "
            "gathered from systems.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference"
            "/exploiters/sshexec/",
        },
        {
            "type": "string",
            "enum": ["HadoopExploiter"],
            "title": "Hadoop/Yarn Exploiter",
            "safe": True,
            "info": "Remote code execution on HADOOP server with YARN and default settings. "
            "Logic based on "
            "https://github.com/vulhub/vulhub/tree/master/hadoop/unauthorized-yarn.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference/exploiters/hadoop/",
        },
        {
            "type": "string",
            "enum": ["ZerologonExploiter"],
            "title": "Zerologon Exploiter",
            "safe": False,
            "info": "Exploits a privilege escalation vulnerability (CVE-2020-1472) in a Windows "
            "server domain controller (DC) by using the Netlogon Remote Protocol (MS-NRPC). "
            "This exploiter changes the password of a Windows server DC account, steals "
            "credentials, and then attempts to restore the original DC password. The victim DC "
            "will be unable to communicate with other DCs until the original "
            "password has been restored. If Infection Monkey fails to restore the "
            "password automatically, you'll have to do it manually. For more "
            "information, see the documentation.",
            "link": "https://www.guardicore.com/infectionmonkey"
            "/docs/reference/exploiters/zerologon/",
        },
        {
            "type": "string",
            "enum": ["PowerShellExploiter"],
            "title": "PowerShell Remoting Exploiter",
            "info": "Exploits PowerShell remote execution setups. PowerShell Remoting uses Windows "
            "Remote Management (WinRM) to allow users to run PowerShell commands on remote "
            "computers.",
            "safe": True,
            "link": "https://www.guardicore.com/infectionmonkey"
            "/docs/reference/exploiters/powershell",
        },
        {
            "type": "string",
            "enum": ["Log4ShellExploiter"],
            "title": "Log4Shell Exploiter",
            "safe": True,
            "info": "Exploits a software vulnerability (CVE-2021-44228) in Apache Log4j, a Java "
            "logging framework. Exploitation is attempted on the following services â€” "
            "Apache Solr, Apache Tomcat, Logstash.",
            "link": "https://www.guardicore.com/infectionmonkey/docs/reference"
            "/exploiters/log4shell/",
        },
    ],
}
