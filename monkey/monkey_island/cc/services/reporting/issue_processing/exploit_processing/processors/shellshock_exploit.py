from monkey_island.cc.services.reporting.issue_processing.exploit_processing.processors.exploit \
    import (
    ExploiterReportInfo,
    ExploitProcessor,
)


class ShellShockExploitProcessor:
    @staticmethod
    def get_exploit_info_by_dict(class_name: str, exploit_dict: dict) -> ExploiterReportInfo:
        exploit_info = ExploitProcessor.get_exploit_info_by_dict(class_name, exploit_dict)

        urls = exploit_dict["data"]["info"]["vulnerable_urls"]
        exploit_info.port = urls[0].split(":")[2].split("/")[0]
        exploit_info.paths = ["/" + url.split(":")[2].split("/")[1] for url in urls]
        return exploit_info
