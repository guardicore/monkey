from agent_plugins.exploiters.smb.src.smb_client import secret_for_type
from tests.data_for_tests.propagation_credentials import LM_HASH, NT_HASH, PASSWORD_1, USERNAME

from common.credentials import Credentials, LMHash, NTHash, Password, Username


def test_secret_for_type__returns_secret_for_password():
    credentials = Credentials(
        identity=Username(username=USERNAME), secret=Password(password=PASSWORD_1)
    )
    assert secret_for_type(credentials, Password) == PASSWORD_1.get_secret_value()


def test_secret_for_type__returns_secret_for_lm_hash():
    credentials = Credentials(identity=Username(username=USERNAME), secret=LMHash(lm_hash=LM_HASH))
    assert secret_for_type(credentials, LMHash) == LM_HASH.get_secret_value()


def test_secret_for_type__returns_secret_for_nt_hash():
    credentials = Credentials(identity=Username(username=USERNAME), secret=NTHash(nt_hash=NT_HASH))
    assert secret_for_type(credentials, NTHash) == NT_HASH.get_secret_value()
