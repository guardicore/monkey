from common.agent_plugins import AgentPluginManifest, AgentPluginType

from .operating_system import OperatingSystem

HARD_CODED_EXPLOITER_MANIFESTS = {
    "ZerologonExploiter": AgentPluginManifest(
        name="ZerologonExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS,),
        title="Zerologon Exploiter",
        description="Exploits a privilege escalation vulnerability (CVE-2020-1472) in a Windows "
        "server domain controller (DC) by using"
        " the Netlogon Remote Protocol (MS-NRPC). "
        "This exploiter changes the password of a Windows server DC account, steals "
        "credentials, and then attempts to restore the original DC password. The "
        "victim DC will be unable to communicate with other DCs until the original "
        "password has been restored. If Infection Monkey fails to restore the "
        "password automatically, you'll have to do it manually. For more "
        "information, see the documentation.",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/"
        "reference/exploiters/zerologon/",
        safe=False,
    ),
    "Log4ShellExploiter": AgentPluginManifest(
        name="Log4ShellExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS, OperatingSystem.LINUX),
        title="Log4Shell Exploiter",
        description="Exploits a software vulnerability (CVE-2021-44228) in Apache Log4j, a Java "
        "logging framework. Exploitation is attempted on the following services â€” "
        "Apache Solr, Apache Tomcat, Logstash.",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference"
        "/exploiters/log4shell/",
        safe=True,
    ),
    "SMBExploiter": AgentPluginManifest(
        name="SMBExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS,),
        title="SMB Exploiter",
        description="Attempts a brute-force attack against SMB using known credentials",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference/"
        "exploiters/smbexec/",
        safe=True,
    ),
    "PowerShellExploiter": AgentPluginManifest(
        name="PowerShellExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS,),
        title="PowerShell Remoting Exploiter",
        description="Exploits PowerShell remote execution setups. "
        "PowerShell Remoting uses Windows Remote Management (WinRM)"
        " to allow users to run PowerShell commands on remote computers.",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference/"
        "exploiters/powershell",
        safe=True,
    ),
    "WmiExploiter": AgentPluginManifest(
        name="WmiExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS,),
        title="WMI Exploiter",
        description="Attempts a brute-force attack against Windows Management Instrumentation "
        "(WMI) using known credentials",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference/"
        "exploiters/wmiexec/",
        safe=True,
    ),
    "MSSQLExploiter": AgentPluginManifest(
        name="MSSQLExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.WINDOWS,),
        title="MSSQL Exploiter",
        description="Attempts a brute-force attack against Microsoft SQL using known "
        "credentials and uses insecure configuration to execute commands on the server.",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference/"
        "exploiters/mssql/",
        safe=True,
    ),
    "SSHExploiter": AgentPluginManifest(
        name="SSHExploiter",
        plugin_type=AgentPluginType.EXPLOITER,
        supported_operating_systems=(OperatingSystem.LINUX, OperatingSystem.WINDOWS),
        target_operating_systems=(OperatingSystem.LINUX,),
        title="SSH Exploiter",
        description="Attempts a brute-force attack against SMB using known credentials, "
        "including SSH keys",
        link_to_documentation="https://www.guardicore.com/infectionmonkey/docs/reference/"
        "exploiters/sshexec/",
        safe=True,
    ),
}
