from pathlib import PurePath

from agentpluginapi import TargetHost

from common.command_builder import IAgentCommandBuilder, MonkeyArgs, RunOptions


def build_ssh_command(
    target_host: TargetHost,
    remote_agent_binary_destination_path: PurePath,
    command_builder: IAgentCommandBuilder,
) -> str:
    run_options = RunOptions(
        agent_destination_path=remote_agent_binary_destination_path,
        monkey_args=MonkeyArgs.AGENT,
        postfix="> /dev/null 2>&1 &",
    )

    run_command = command_builder.build_run_command(run_options)
    return run_command
