from common.event_queue import IAgentEventPublisher
from infection_monkey.exploit.tools import IRemoteAccessClientBuilder
from infection_monkey.i_puppet import TargetHost

from .smb_exploit_client import SMBExploitClient
from .smb_options import SMBOptions


class SMBExploitClientBuilder(IRemoteAccessClientBuilder):
    def __init__(self, agent_event_publisher: IAgentEventPublisher):
        self._agent_event_publisher = agent_event_publisher

    def build_client(self, host: TargetHost, options: SMBOptions) -> SMBExploitClient:
        return SMBExploitClient(self._agent_event_publisher)
