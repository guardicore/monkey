from typing import Any

from infection_monkey.exploit.tools import IRemoteAccessClientFactory
from infection_monkey.i_puppet import TargetHost

from .smb_exploit_client import SMBExploitClient
from .smb_options import SMBOptions


class SMBExploitClientFactory(IRemoteAccessClientFactory):
    def __init__(
        self,
        host: TargetHost,
        options: SMBOptions,
    ):
        self._host = host
        self._options = options

    def create(self, **kwargs: Any) -> SMBExploitClient:
        return SMBExploitClient(self._host, self._options)
