from typing import Dict

from aardwolf.extensions.RDPECLIP.fileprovider import FileProvider


class InMemoryFileProvider(FileProvider):
    """
    Provides data from files stored in memory to the clipboard
    """

    def __init__(self, files: Dict[str, bytes] = None):
        self._files: Dict[str, bytes] = {} if files is None else files

    def set_files(self, files: Dict[str, bytes]):
        self._files.clear()
        self._files.update(files)

    def get_file_data(self, name: str, start: int, count: int) -> bytes:
        return self._files[name][start : start + count]

    def get_file_size(self, name: str) -> int:
        return len(self._files[name])

    def __deepcopy__(self, memo):
        return InMemoryFileProvider(self._files)
