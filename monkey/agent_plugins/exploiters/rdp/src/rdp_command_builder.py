import logging
from pathlib import PurePath

from common.command_builder import IAgentCommandBuilder, MonkeyArgs, RunOptions, Shell
from infection_monkey.model import CMD_PREFIX

logger = logging.getLogger(__name__)


def build_rdp_command(
    remote_agent_binary_destination_path: PurePath, agent_command_builder: IAgentCommandBuilder
):
    run_options = RunOptions(
        monkey_args=MonkeyArgs.DROPPER,
        agent_destination_path=remote_agent_binary_destination_path,
        shell=Shell.CMD,
    )
    command = agent_command_builder.build_run_command(run_options)
    logger.debug(f"COMMAND: {command}")

    return command
